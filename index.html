<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HUB HTML - GLOBAL CONNECT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { background: #020617; color: white; font-family: sans-serif; overflow: hidden; }
        .glass { background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.05); }
        .neon-glow { box-shadow: 0 0 20px rgba(56, 189, 248, 0.15); border: 1px solid rgba(56, 189, 248, 0.4); }
        iframe { background: white; width: 100%; height: 100%; border: none; border-radius: 2.5rem; }
        textarea { scrollbar-width: none; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ESTE É O ID QUE JÁ VEM COLADO PARA TODO MUNDO
        const PUBLIC_ROOM_ID = "HUB_HTML_SALA_PUBLICA_2025";

        const App = () => {
            const [myId, setMyId] = useState('');
            const [targetId, setTargetId] = useState(PUBLIC_ROOM_ID); // Já inicia com o ID Público
            const [mode, setMode] = useState('LOCAL'); 
            const [role, setRole] = useState('WASH'); 
            const [code, setCode] = useState("<h1>HUB HTML ONLINE</h1>\n<p>Conecte-se para compartilhar!</p>");
            const [conn, setConn] = useState(null);
            const peerRef = useRef(null);

            useEffect(() => {
                const peer = new Peer();
                peerRef.current = peer;
                peer.on('open', id => setMyId(id));
                peer.on('connection', (c) => {
                    setConn(c);
                    setMode('SALA PÚBLICA');
                    setRole('ESPECTADOR');
                    c.on('data', data => { if(data.type === 'SYNC') setCode(data.value); });
                });
                return () => peer.destroy();
            }, []);

            const connectP2P = () => {
                if(!targetId) return;
                const c = peerRef.current.connect(targetId);
                setConn(c);
                setMode(targetId === PUBLIC_ROOM_ID ? 'SALA PÚBLICA' : 'PRIVADO');
                setRole('WASH');
                c.on('data', data => { if(data.type === 'SYNC') setCode(data.value); });
            };

            const updateCode = (val) => {
                setCode(val);
                if(conn && conn.open) {
                    conn.send({ type: 'SYNC', value: val });
                }
            };

            return (
                <div className="h-screen flex flex-col p-4 gap-4">
                    {/* HUB CONTROLLER */}
                    <header className="glass p-5 rounded-[2.5rem] flex flex-col lg:flex-row justify-between items-center gap-6 neon-glow">
                        <div className="flex items-center gap-4">
                            <div className="w-12 h-12 bg-sky-500 rounded-2xl flex items-center justify-center text-slate-950 shadow-[0_0_15px_rgba(56,189,248,0.5)]">
                                <i data-lucide="zap" fill="currentColor"></i>
                            </div>
                            <div>
                                <h1 className="font-black italic text-2xl tracking-tighter">HUB HTML</h1>
                                <span className="text-[10px] font-bold text-sky-400 uppercase tracking-widest">{mode}</span>
                            </div>
                        </div>

                        <div className="flex flex-wrap justify-center items-center gap-4">
                            <div className="bg-black/40 px-4 py-2 rounded-2xl border border-white/5 text-center">
                                <p className="text-[8px] text-slate-500 font-bold uppercase">Seu ID Pessoal (Passe para amigos)</p>
                                <p className="text-[10px] font-mono text-sky-200 select-all">{myId || 'Conectando rede...'}</p>
                            </div>

                            <div className="flex bg-slate-900 p-1 rounded-2xl border border-white/10">
                                <input 
                                    value={targetId}
                                    onChange={(e) => setTargetId(e.target.value)}
                                    placeholder="ID do Parceiro..." 
                                    className="bg-transparent px-4 py-2 text-xs outline-none w-48 font-bold text-sky-400"
                                />
                                <button onClick={connectP2P} className="bg-sky-500 text-slate-950 px-6 py-2 rounded-xl font-black text-xs uppercase hover:brightness-110 active:scale-95 transition-all">
                                    Conectar
                                </button>
                            </div>
                        </div>
                    </header>

                    {/* STUDIO */}
                    <main className="flex-1 grid lg:grid-cols-2 gap-4 min-h-0">
                        <div className="flex flex-col gap-3">
                            <div className="flex justify-between items-center px-4">
                                <span className="text-[10px] font-black text-slate-500 uppercase tracking-[0.3em] flex items-center gap-2">
                                    <i data-lucide="terminal" className="w-3 text-sky-500"></i> {role} MODE
                                </span>
                            </div>
                            <textarea 
                                value={code}
                                onChange={(e) => updateCode(e.target.value)}
                                className="flex-1 bg-slate-900/40 p-8 rounded-[3rem] border border-white/5 outline-none font-mono text-[11px] text-sky-300 resize-none shadow-inner focus:border-sky-500/30 transition-all"
                                placeholder="Insira o código HTML..."
                            ></textarea>
                        </div>

                        <div className="relative rounded-[3rem] overflow-hidden shadow-2xl border-4 border-slate-900">
                            <div className="absolute bottom-6 right-8 bg-sky-500 text-slate-950 text-[8px] font-black px-3 py-1 rounded-full z-10 uppercase tracking-widest animate-pulse">
                                Live Preview
                            </div>
                            <iframe id="pv" srcDoc={code}></iframe>
                        </div>
                    </main>

                    <footer className="px-8 py-1 flex justify-between text-[9px] font-bold text-slate-700 uppercase tracking-widest">
                        <span>P2P Engine: PeerJS</span>
                        <span className={conn ? 'text-green-500' : ''}>{conn ? 'Conectado com Sucesso' : 'Offline'}</span>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
        setTimeout(() => lucide.createIcons(), 500);
    </script>
</body>
</html>
